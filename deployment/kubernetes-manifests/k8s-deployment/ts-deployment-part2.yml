# apiVersion: v1
# kind: Service
# metadata:
#   name: rest-service-collect
#   labels:
#     app: rest-service-collect
# spec:
#   type: NodePort
#   ports:
#     - port: 9413
#   selector:
#     app: rest-service-collect
# ---


# apiVersion: extensions/v1beta1
# kind: Deployment
# metadata:
#   name: rest-service-collect
# spec:
#   replicas: 1
#   template:
#     metadata:
#       labels:
#         app: rest-service-collect
#         version: v1
#     spec:
#       nodeName: k8snode3
#       containers:
#       - name: rest-service-collect
#         image: header/rest-service-collect
#         imagePullPolicy: Always
#         ports:
#         - containerPort: 9413
#         volumeMounts:
#         - name: collect
#           mountPath: /parquet
#       volumes:
#       - name: collect
#         hostPath:
#           path: /home/parquet

---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-admin-basic-info-service
spec:
  selector:
    matchLabels:
      app: ts-admin-basic-info-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-admin-basic-info-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-admin-basic-info-service
        image: newrelic/train-ticket:ts-admin-basic-info-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 18767
        resources:
          requests:
            cpu: 50m
            memory: 100Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18767
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18767
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-admin-order-service
spec:
  selector:
    matchLabels:
      app: ts-admin-order-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-admin-order-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-admin-order-service
        image: newrelic/train-ticket:ts-admin-order-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 16112
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16112
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16112
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-admin-route-service
spec:
  selector:
    matchLabels:
      app: ts-admin-route-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-admin-route-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-admin-route-service
        image: newrelic/train-ticket:ts-admin-route-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 16113
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16113
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16113
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-admin-travel-service
spec:
  selector:
    matchLabels:
      app: ts-admin-travel-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-admin-travel-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-admin-travel-service
        image: newrelic/train-ticket:ts-admin-travel-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 16114
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16114
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16114
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-admin-user-service
spec:
  selector:
    matchLabels:
      app: ts-admin-user-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-admin-user-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-admin-user-service
        image: newrelic/train-ticket:ts-admin-user-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 16115
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16115
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16115
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-assurance-service
spec:
  selector:
    matchLabels:
      app: ts-assurance-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-assurance-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-assurance-service
        image: newrelic/train-ticket:ts-assurance-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: ASSURANCE_MYSQL_HOST
          value: "ts-assurance-mysql"
        - name: ASSURANCE_MYSQL_PORT
          value: "3306"
        - name: ASSURANCE_MYSQL_DATABASE
          value: "ts-assurance-mysql"
        - name: ASSURANCE_MYSQL_USER
          value: "root"
        - name: ASSURANCE_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 18888
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18888
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18888
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-basic-service
spec:
  selector:
    matchLabels:
      app: ts-basic-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-basic-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-basic-service
        image: newrelic/train-ticket:ts-basic-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 15680
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 15680
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 15680
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-cancel-service
spec:
  selector:
    matchLabels:
      app: ts-cancel-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-cancel-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-cancel-service
        image: newrelic/train-ticket:ts-cancel-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 18885
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18885
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18885
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-config-service
spec:
  selector:
    matchLabels:
      app: ts-config-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-config-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-config-service
        image: newrelic/train-ticket:ts-config-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: CONFIG_MYSQL_HOST
          value: "ts-config-mysql"
        - name: CONFIG_MYSQL_PORT
          value: "3306"
        - name: CONFIG_MYSQL_DATABASE
          value: "ts-config-mysql"
        - name: CONFIG_MYSQL_USER
          value: "root"
        - name: CONFIG_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 15679
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 15679
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 15679
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-consign-price-service
spec:
  selector:
    matchLabels:
      app: ts-consign-price-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-consign-price-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-consign-price-service
        image: newrelic/train-ticket:ts-consign-price-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: CONSIGN_PRICE_MYSQL_HOST
          value: "ts-consign-price-mysql"
        - name: CONSIGN_PRICE_MYSQL_PORT
          value: "3306"
        - name: CONSIGN_PRICE_MYSQL_DATABASE
          value: "ts-consign-price-mysql"
        - name: CONSIGN_PRICE_MYSQL_USER
          value: "root"
        - name: CONSIGN_PRICE_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 16110
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16110
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16110
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-consign-service
spec:
  selector:
    matchLabels:
      app: ts-consign-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-consign-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-consign-service
        image: newrelic/train-ticket:ts-consign-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: CONSIGN_MYSQL_HOST
          value: "ts-consign-mysql"
        - name: CONSIGN_MYSQL_PORT
          value: "3306"
        - name: CONSIGN_MYSQL_DATABASE
          value: "ts-consign-mysql"
        - name: CONSIGN_MYSQL_USER
          value: "root"
        - name: CONSIGN_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 16111
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16111
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16111
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-contacts-service
spec:
  selector:
    matchLabels:
      app: ts-contacts-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-contacts-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-contacts-service
        image: newrelic/train-ticket:ts-contacts-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: CONTACTS_MYSQL_HOST
          value: "ts-contacts-mysql"
        - name: CONTACTS_MYSQL_PORT
          value: "3306"
        - name: CONTACTS_MYSQL_DATABASE
          value: "ts-contacts-mysql"
        - name: CONTACTS_MYSQL_USER
          value: "root"
        - name: CONTACTS_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 12347
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12347
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12347
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-execute-service
spec:
  selector:
    matchLabels:
      app: ts-execute-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-execute-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-execute-service
        image: newrelic/train-ticket:ts-execute-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 12386
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12386
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12386
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-food-map-service
spec:
  selector:
    matchLabels:
      app: ts-food-map-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-food-map-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-food-map-service
        image: newrelic/train-ticket:ts-food-map-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 18855
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18855
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18855
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-food-service
spec:
  selector:
    matchLabels:
      app: ts-food-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-food-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-food-service
        image: newrelic/train-ticket:ts-food-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: FOOD_MYSQL_HOST
          value: "ts-food-mysql"
        - name: FOOD_MYSQL_PORT
          value: "3306"
        - name: FOOD_MYSQL_DATABASE
          value: "ts-food-mysql"
        - name: FOOD_MYSQL_USER
          value: "root"
        - name: FOOD_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 18856
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18856
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18856
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-inside-payment-service
spec:
  selector:
    matchLabels:
      app: ts-inside-payment-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-inside-payment-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-inside-payment-service
        image: newrelic/train-ticket:ts-inside-payment-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: INSIDE_PAYMENT_MYSQL_HOST
          value: "ts-inside-payment-mysql"
        - name: INSIDE_PAYMENT_MYSQL_PORT
          value: "3306"
        - name: INSIDE_PAYMENT_MYSQL_DATABASE
          value: "ts-inside-payment-mysql"
        - name: INSIDE_PAYMENT_MYSQL_USER
          value: "root"
        - name: INSIDE_PAYMENT_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 18673
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18673
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18673
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-auth-service
spec:
  selector:
    matchLabels:
      app: ts-auth-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-auth-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-auth-service
        image: newrelic/train-ticket:ts-auth-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 12340
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12340
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12340
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-news-service
spec:
  selector:
    matchLabels:
      app: ts-news-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-news-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-news-service
        image: newrelic/train-ticket:ts-news-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 12862
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12862
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12862
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-notification-service
spec:
  selector:
    matchLabels:
      app: ts-notification-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-notification-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-notification-service
        image: newrelic/train-ticket:ts-notification-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: NOTIFICATION_MYSQL_HOST
          value: "ts-notification-mysql"
        - name: NOTIFICATION_MYSQL_PORT
          value: "3306"
        - name: NOTIFICATION_MYSQL_DATABASE
          value: "ts-notification-mysql"
        ports:
        - containerPort: 17853
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 17853
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 17853
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-order-other-service
spec:
  selector:
    matchLabels:
      app: ts-order-other-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-order-other-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-order-other-service
        image: newrelic/train-ticket:ts-order-other-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: ORDER_OTHER_MYSQL_HOST
          value: "ts-order-other-mysql"
        - name: ORDER_OTHER_MYSQL_PORT
          value: "3306"
        - name: ORDER_OTHER_MYSQL_DATABASE
          value: "ts-order-other-mysql"
        - name: ORDER_OTHER_MYSQL_USER
          value: "root"
        - name: ORDER_OTHER_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 12032
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12032
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12032
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-order-service
spec:
  selector:
    matchLabels:
      app: ts-order-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-order-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-order-service
        image: newrelic/train-ticket:ts-order-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: ORDER_MYSQL_HOST
          value: "ts-order-mysql"
        - name: ORDER_MYSQL_PORT
          value: "3306"
        - name: ORDER_MYSQL_DATABASE
          value: "ts-order-mysql"
        - name: ORDER_MYSQL_USER
          value: "root"
        - name: ORDER_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 12031
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12031
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12031
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-payment-service
spec:
  selector:
    matchLabels:
      app: ts-payment-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-payment-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-payment-service
        image: newrelic/train-ticket:ts-payment-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: PAYMENT_MYSQL_HOST
          value: "ts-payment-mysql"
        - name: PAYMENT_MYSQL_PORT
          value: "3306"
        - name: PAYMENT_MYSQL_DATABASE
          value: "ts-payment-mysql"
        - name: PAYMENT_MYSQL_USER
          value: "root"
        - name: PAYMENT_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 19001
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 19001
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 19001
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-preserve-other-service
spec:
  selector:
    matchLabels:
      app: ts-preserve-other-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-preserve-other-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-preserve-other-service
        image: newrelic/train-ticket:ts-preserve-other-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 14569
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 14569
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 14569
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-preserve-service
spec:
  selector:
    matchLabels:
      app: ts-preserve-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-preserve-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-preserve-service
        image: newrelic/train-ticket:ts-preserve-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 14568
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 14568
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 14568
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-price-service
spec:
  selector:
    matchLabels:
      app: ts-price-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-price-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-price-service
        image: newrelic/train-ticket:ts-price-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: PRICE_MYSQL_HOST
          value: "ts-price-mysql"
        - name: PRICE_MYSQL_PORT
          value: "3306"
        - name: PRICE_MYSQL_DATABASE
          value: "ts-price-mysql"
        - name: PRICE_MYSQL_USER
          value: "root"
        - name: PRICE_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 16579
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16579
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16579
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-rebook-service
spec:
  selector:
    matchLabels:
      app: ts-rebook-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-rebook-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-rebook-service
        image: newrelic/train-ticket:ts-rebook-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 18886
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18886
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18886
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-route-plan-service
spec:
  selector:
    matchLabels:
      app: ts-route-plan-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-route-plan-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-route-plan-service
        image: newrelic/train-ticket:ts-route-plan-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 14578
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 14578
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 14578
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-route-service
spec:
  selector:
    matchLabels:
      app: ts-route-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-route-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-route-service
        image: newrelic/train-ticket:ts-route-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: ROUTE_MYSQL_HOST
          value: "ts-route-mysql"
        - name: ROUTE_MYSQL_PORT
          value: "3306"
        - name: ROUTE_MYSQL_DATABASE
          value: "ts-route-mysql"
        - name: ROUTE_MYSQL_USER
          value: "root"
        - name: ROUTE_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 11178
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 11178
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 11178
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-seat-service
spec:
  selector:
    matchLabels:
      app: ts-seat-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-seat-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-seat-service
        image: newrelic/train-ticket:ts-seat-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 18898
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18898
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18898
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-security-service
spec:
  selector:
    matchLabels:
      app: ts-security-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-security-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-security-service
        image: newrelic/train-ticket:ts-security-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: SECURITY_MYSQL_HOST
          value: "ts-security-mysql"
        - name: SECURITY_MYSQL_PORT
          value: "3306"
        - name: SECURITY_MYSQL_DATABASE
          value: "ts-security-mysql"
        - name: SECURITY_MYSQL_USER
          value: "root"
        - name: SECURITY_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 11188
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 11188
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 11188
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-user-service
spec:
  selector:
    matchLabels:
      app: ts-user-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-user-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-user-service
        image: newrelic/train-ticket:ts-user-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 12342
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12342
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12342
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-station-service
spec:
  selector:
    matchLabels:
      app: ts-station-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-station-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-station-service
        image: newrelic/train-ticket:ts-station-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: STATION_MYSQL_HOST
          value: "ts-station-mysql"
        - name: STATION_MYSQL_PORT
          value: "3306"
        - name: STATION_MYSQL_DATABASE
          value: "ts-station-mysql"
        - name: STATION_MYSQL_USER
          value: "root"
        - name: STATION_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 12345
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12345
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12345
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-ticket-office-service
spec:
  selector:
    matchLabels:
      app: ts-ticket-office-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-ticket-office-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-ticket-office-service
        image: newrelic/train-ticket:ts-ticket-office-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 16108
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16108
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16108
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-ticketinfo-service
spec:
  selector:
    matchLabels:
      app: ts-ticketinfo-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-ticketinfo-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-ticketinfo-service
        image: newrelic/train-ticket:ts-ticketinfo-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 15681
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 15681
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 15681
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-train-service
spec:
  selector:
    matchLabels:
      app: ts-train-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-train-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-train-service
        image: newrelic/train-ticket:ts-train-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: TRAIN_MYSQL_HOST
          value: "ts-train-mysql"
        - name: TRAIN_MYSQL_PORT
          value: "3306"
        - name: TRAIN_MYSQL_DATABASE
          value: "ts-train-mysql"
        - name: TRAIN_MYSQL_USER
          value: "root"
        - name: TRAIN_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 14567
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 14567
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 14567
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-travel2-service
spec:
  selector:
    matchLabels:
      app: ts-travel2-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-travel2-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-travel2-service
        image: newrelic/train-ticket:ts-travel2-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: TRAVEL2_MYSQL_HOST
          value: "ts-travel2-mysql"
        - name: TRAVEL2_MYSQL_PORT
          value: "3306"
        - name: TRAVEL2_MYSQL_DATABASE
          value: "ts-travel2-mysql"
        - name: TRAVEL2_MYSQL_USER
          value: "root"
        - name: TRAVEL2_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 16346
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16346
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16346
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-travel-plan-service
spec:
  selector:
    matchLabels:
      app: ts-travel-plan-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-travel-plan-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-travel-plan-service
        image: newrelic/train-ticket:ts-travel-plan-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 14322
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 14322
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 14322
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-travel-service
spec:
  selector:
    matchLabels:
      app: ts-travel-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-travel-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-travel-service
        image: newrelic/train-ticket:ts-travel-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: TRAVEL_MYSQL_HOST
          value: "ts-travel-mysql"
        - name: TRAVEL_MYSQL_PORT
          value: "3306"
        - name: TRAVEL_MYSQL_DATABASE
          value: "ts-travel-mysql"
        - name: TRAVEL_MYSQL_USER
          value: "root"
        - name: TRAVEL_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 12346
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 12346
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 12346
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-verification-code-service
spec:
  selector:
    matchLabels:
      app: ts-verification-code-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-verification-code-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node4
      containers:
      - name: ts-verification-code-service
        image: newrelic/train-ticket:ts-verification-code-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 15678
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 15678
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 15678
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-voucher-service
spec:
  selector:
    matchLabels:
      app: ts-voucher-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-voucher-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node2
      containers:
      - name: ts-voucher-service
        image: newrelic/train-ticket:ts-voucher-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 16101
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 16101
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 16101
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-avatar-service
spec:
  selector:
    matchLabels:
      app: ts-avatar-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-avatar-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-avatar-service
        image: newrelic/train-ticket:ts-avatar-service-0.1.0
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        ports:
        - containerPort: 17001
        resources:
          requests:
            cpu: 50m
            memory: 200Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 17001
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 17001
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-admin-basic-info-service
spec:
  ports:
  - name: http
    port: 18767
  selector:
    app: ts-admin-basic-info-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-admin-order-service
spec:
  ports:
  - name: http
    port: 16112
  selector:
    app: ts-admin-order-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-admin-route-service
spec:
  ports:
  - name: http
    port: 16113
  selector:
    app: ts-admin-route-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-admin-travel-service
spec:
  ports:
  - name: http
    port: 16114
  selector:
    app: ts-admin-travel-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-admin-user-service
spec:
  ports:
  - name: http
    port: 16115
  selector:
    app: ts-admin-user-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-assurance-service
spec:
  ports:
  - name: http
    port: 18888
  selector:
    app: ts-assurance-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-basic-service
spec:
  ports:
  - name: http
    port: 15680
  selector:
    app: ts-basic-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-cancel-service
spec:
  ports:
  - name: http
    port: 18885
  selector:
    app: ts-cancel-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-config-service
spec:
  ports:
  - name: http
    port: 15679
  selector:
    app: ts-config-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-consign-price-service
spec:
  ports:
  - name: http
    port: 16110
  selector:
    app: ts-consign-price-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-consign-service
spec:
  ports:
  - name: http
    port: 16111
  selector:
    app: ts-consign-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-contacts-service
spec:
  ports:
  - name: http
    port: 12347
  selector:
    app: ts-contacts-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-execute-service
spec:
  ports:
  - name: http
    port: 12386
  selector:
    app: ts-execute-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-food-map-service
spec:
  ports:
  - name: http
    port: 18855
  selector:
    app: ts-food-map-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-food-service
spec:
  ports:
  - name: http
    port: 18856
  selector:
    app: ts-food-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-inside-payment-service
spec:
  ports:
  - name: http
    port: 18673
  selector:
    app: ts-inside-payment-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-user-service
spec:
  ports:
  - name: http
    port: 12342
  selector:
    app: ts-user-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-notification-service
spec:
  ports:
  - name: http
    port: 17853
  selector:
    app: ts-notification-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-news-service
spec:
  ports:
  - name: http
    port: 12862
  selector:
    app: ts-news-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-order-other-service
spec:
  ports:
  - name: http
    port: 12032
  selector:
    app: ts-order-other-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-order-service
spec:
  ports:
  - name: http
    port: 12031
  selector:
    app: ts-order-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-payment-service
spec:
  ports:
  - name: http
    port: 19001
  selector:
    app: ts-payment-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-preserve-other-service
spec:
  ports:
  - name: http
    port: 14569
  selector:
    app: ts-preserve-other-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-preserve-service
spec:
  ports:
  - name: http
    port: 14568
  selector:
    app: ts-preserve-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-price-service
spec:
  ports:
  - name: http
    port: 16579
  selector:
    app: ts-price-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-rebook-service
spec:
  ports:
  - name: http
    port: 18886
  selector:
    app: ts-rebook-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-route-plan-service
spec:
  ports:
  - name: http
    port: 14578
  selector:
    app: ts-route-plan-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-route-service
spec:
  ports:
  - name: http
    port: 11178
  selector:
    app: ts-route-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-seat-service
spec:
  ports:
  - name: http
    port: 18898
  selector:
    app: ts-seat-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-security-service
spec:
  ports:
  - name: http
    port: 11188
  selector:
    app: ts-security-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-auth-service
spec:
  type: LoadBalancer
  ports:
  - name: http
    port: 12340
  selector:
    app: ts-auth-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-station-service
spec:
  ports:
  - name: http
    port: 12345
  selector:
    app: ts-station-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-ticket-office-service
spec:
  ports:
  - name: http
    port: 16108
  selector:
    app: ts-ticket-office-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-ticketinfo-service
spec:
  ports:
  - name: http
    port: 15681
  selector:
    app: ts-ticketinfo-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-train-service
spec:
  ports:
  - name: http
    port: 14567
  selector:
    app: ts-train-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-travel2-service
spec:
  ports:
  - name: http
    port: 16346
  selector:
    app: ts-travel2-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-travel-plan-service
spec:
  ports:
  - name: http
    port: 14322
  selector:
    app: ts-travel-plan-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-travel-service
spec:
  ports:
  - name: http
    port: 12346
  selector:
    app: ts-travel-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-verification-code-service
spec:
  ports:
  - name: http
    port: 15678
  selector:
    app: ts-verification-code-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-voucher-service
spec:
  ports:
  - name: http
    port: 16101
  selector:
    app: ts-voucher-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-avatar-service
spec:
  ports:
  - name: http
    port: 17001
  selector:
    app: ts-avatar-service
# =============================================================================
# Missing Services to Add to ts-deployment-part2.yml
# Add these at the end of the file (after line 2923)
# =============================================================================

---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-delivery-service
spec:
  selector:
    matchLabels:
      app: ts-delivery-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-delivery-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-delivery-service
        image: newrelic/train-ticket:ts-delivery-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: DELIVERY_MYSQL_HOST
          value: "ts-delivery-mysql"
        - name: DELIVERY_MYSQL_PORT
          value: "3306"
        - name: DELIVERY_MYSQL_DATABASE
          value: "ts-delivery-mysql"
        - name: DELIVERY_MYSQL_USER
          value: "root"
        - name: DELIVERY_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 18808
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18808
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18808
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-food-delivery-service
spec:
  selector:
    matchLabels:
      app: ts-food-delivery-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-food-delivery-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-food-delivery-service
        image: newrelic/train-ticket:ts-food-delivery-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: FOOD_DELIVERY_MYSQL_HOST
          value: "ts-food-delivery-mysql"
        - name: FOOD_DELIVERY_MYSQL_PORT
          value: "3306"
        - name: FOOD_DELIVERY_MYSQL_DATABASE
          value: "ts-food-delivery-mysql"
        - name: FOOD_DELIVERY_MYSQL_USER
          value: "root"
        - name: FOOD_DELIVERY_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 18957
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18957
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18957
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-station-food-service
spec:
  selector:
    matchLabels:
      app: ts-station-food-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-station-food-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-station-food-service
        image: newrelic/train-ticket:ts-station-food-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: STATION_FOOD_MYSQL_HOST
          value: "ts-station-food-mysql"
        - name: STATION_FOOD_MYSQL_PORT
          value: "3306"
        - name: STATION_FOOD_MYSQL_DATABASE
          value: "ts-station-food-mysql"
        - name: STATION_FOOD_MYSQL_USER
          value: "root"
        - name: STATION_FOOD_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 18855
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 18855
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 18855
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-train-food-service
spec:
  selector:
    matchLabels:
      app: ts-train-food-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-train-food-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-train-food-service
        image: newrelic/train-ticket:ts-train-food-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: TRAIN_FOOD_MYSQL_HOST
          value: "ts-train-food-mysql"
        - name: TRAIN_FOOD_MYSQL_PORT
          value: "3306"
        - name: TRAIN_FOOD_MYSQL_DATABASE
          value: "ts-train-food-mysql"
        - name: TRAIN_FOOD_MYSQL_USER
          value: "root"
        - name: TRAIN_FOOD_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 19999
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 19999
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 19999
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
apiVersion: apps/v1
kind: Deployment
metadata:
  namespace: store
  name: ts-wait-order-service
spec:
  selector:
    matchLabels:
      app: ts-wait-order-service
  replicas: 1
  template:
    metadata:
      labels:
        app: ts-wait-order-service
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: role
                operator: In
                values:
                - node3
      containers:
      - name: ts-wait-order-service
        image: newrelic/train-ticket:ts-wait-order-service-0.0.4
        imagePullPolicy: Always
        env:
        - name: SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR
          value: "nacos.store.svc.cluster.local:8848"
        - name: SPRING_CLOUD_NACOS_DISCOVERY_FAIL_FAST
          value: "false"
        - name: WAIT_ORDER_MYSQL_HOST
          value: "ts-wait-order-mysql"
        - name: WAIT_ORDER_MYSQL_PORT
          value: "3306"
        - name: WAIT_ORDER_MYSQL_DATABASE
          value: "ts-wait-order-mysql"
        - name: WAIT_ORDER_MYSQL_USER
          value: "root"
        - name: WAIT_ORDER_MYSQL_PASSWORD
          value: "root"
        ports:
        - containerPort: 17525
        resources:
          requests:
            cpu: 50m
            memory: 160Mi
          limits:
            cpu: 200m
            memory: 500Mi
        startupProbe:
          tcpSocket:
            port: 17525
          initialDelaySeconds: 90
          failureThreshold: 40
          periodSeconds: 5
        readinessProbe:
          tcpSocket:
            port: 17525
          initialDelaySeconds: 120
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
---
# =============================================================================
# Services
# =============================================================================
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-delivery-service
spec:
  ports:
  - name: http
    port: 18808
  selector:
    app: ts-delivery-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-food-delivery-service
spec:
  ports:
  - name: http
    port: 18957
  selector:
    app: ts-food-delivery-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-station-food-service
spec:
  ports:
  - name: http
    port: 18855
  selector:
    app: ts-station-food-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-train-food-service
spec:
  ports:
  - name: http
    port: 19999
  selector:
    app: ts-train-food-service
---
apiVersion: v1
kind: Service
metadata:
  namespace: store
  name: ts-wait-order-service
spec:
  ports:
  - name: http
    port: 17525
  selector:
    app: ts-wait-order-service
